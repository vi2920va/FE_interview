# JavaScript - 데이터 타입

## 설명

### 1. 데이터 타입의 종류

자바스크립트 데이터 타입에는 크게 기본형과 참조형 두 가지가 있습니다.

![image](https://user-images.githubusercontent.com/47317129/148237616-44fbfee3-dabc-42fd-8b42-40af815aaa9c.png)

1. 기본형(원시형, primitive type)
   1.1. 숫자
   1.2. 문자열
   1.3. 불린
   1.4. null
   1.5. undefined
   1.6. symbol // ES6
2. 참조형(reference type)
   2.1. 객체
   2.2. 배열
   2.3. 함수
   2.4. 날짜(Date)
   2.5. 정규표현식
   2.6 Map // 여기서부터 ES6에서 추가된 타입
   2.7 WeakMap
   2.8. Set
   2.9. WeakSet
   etc.

보통 기본형과 참조형을 구분하는 기준으로,
기본형은 할당이나 연산 시 복제되고 참조형은 참조되는 것으로 알고있습니다.

하지만 엄밀히 말하면 둘 모두 복제됩니다.
다만 기본형은 값이 담긴 주솟값을 바로 복제하는 반면,
차모형은 값이 담긴 주솟값들로 이루어진 묶음을 가리키는 주솟값을 복제한다는 점이 다릅니다.

그리고 기본형은 불변값이고 참조형은 가변값입니다.

자세한 내용은 4번에서 마저 다루도록 하겠습니다.

### 2. 데이터 타입에 관한 배경지식

#### 2.1. 메모리와 데이터

컴퓨터는 모든 데이터를 0 또는 1로 바꿔 기억합니다. 하나의 메모리 조각을 비트라고 하고, 메모리는 많은 비트들로 구성되어 있는데 각 비트는 고유한 식별자를 통해 위치를 확인할 수 있습니다.

이런 비트를 한 단위로 묶으면 검색 시간을 줄일 수 있고 표현할 수 있는 데이터의 개수도 늘어나지만 동시에 낭비되는 비트도 생깁니다. 이런 고민의 결과로 바이트(byte)라는 단위가 생겼습니다. 1바이트는 8개의 비트로 구성되어있고 1비트마다 0 또는 1의 두가지 값을 표현할 수 있으므로 1바이트는 총 256개의 값을 표현할 수 있습니다.

정적 타입 언어(C/C++,java)는 메모리의 낭비를 최소화하기 위해 데이터 타입별로 할당 메모리 영역을 정해놓았습니다. 숫자형 데이터를 저장할 경우 정해진 숫자만 허용하고 이상의 숫자를 입력하면 오류가 나거나 잘못된 값이 저장되므로 이를 대처하기 위해서는 사용자가 직접 변환해야하는(int) 번거로운 작업이 필요했습니다.

한편 메모리 용량이 과거보다 월등히 커진 상황에서 등장한 자바스크립트는 상대적으로 메모리 관리에 대한 압박에서 자유로워졌습니다. 때문에 메모리 공간을 좀 더 넉넉하게 할당했고 위와같은 번거로운 상황이 덜 발생하게 되었습니다.

#### 2.2. 식별자와 변수

변수는 변할 수 있는 데이터를 의미합니다.

식별자는 어떤 데이터를 식별하는 데 사용하는 이름, 즉 **변수명**입니다.

### 3. 변수 선언과 데이터 할당

#### 3.1. 변수 선언

```javascript
var a;
```

변수란 변경 가능한 데이터가 담길 수 있는 공간, 또는 그릇입니다. 어떤 변수를 선언하면 컴퓨터는 메모리에서 a라는 변수명을 가진 주소를 검색해 해당 공간에 담긴 데이터를 반환할 것입니다.

#### 3.2. 데이터 할당

```javascript
var a;
a = "abc";

var a = "abc";
```

a라는 이름을 가진 주소를 검색해서 'abc'라는 문자열을 할당할 때 해당 위치에 문자열 'abc'를 저장하고, 그 주소를 변수 영역에 저장하는 식으로 이루어집니다.

변수 영역에 값을 직접 대입하지 않고 굳이 번거롭게 한단계를 거치는 이유는 바로 데이터 변환을 자유롭게 할 수 있게 함과 동시에 메모리를 더욱 효율적으로 관리하기 위함입니다.

예를 들어, 숫자형과 다르게 문자열은 특별히 정해진 데이터 규격이 없기 때문에 메모리 용량이 가변적입니다. 만약 미리 확보한 공간 내에서만 데이터 변환을 하게된다면, 변환된 데이터를 다시 저장해야할 경우 확보된 공간을 변환된 데이터 크기에 맞게 늘리는 작업이 선행되어야 합니다. 이 때 중간에 있는 데이터라고 가정한다면 해당 공간보다 뒤에 저장된 데이터들을 전부 뒤로 옮기고, 이동시킨 주소를 각 실별자에 다시 연결해야하는 번거로움이 발생합니다.

결국 효율적으로 문자열 데이터의 변환을 처리하려면 변수와 데이터를 별도의 공간에 나누어 저장하는 것이 최적의 방법입니다.

어떤 변수에서 문자열을 저장하고 나중에 새로 문자열을 추가할 경우, 저장된 공간에 바뀐 데이터를 할당하는 것이 아닌 변경될 데이터를 새로 만들어 별도의 공간에 저장하고 그 주소를 변수 공간에 연결합니다.

즉, 변수명이 데이터를 저장하는 방식은 위에서 언급했던 것처럼 **직접 데이터를 저장하는 것이 아니라 해당 데이터를 가진 주솟값을 저장하는 것입니다.**

때문에 중복된 데이터를 처리할 때에도 효율성이 높아지는 장점이 있습니다.

### 4. 기본형 데이터와 참조형 데이터

#### 4.1. 불변값

변수(variable)와 상수(constant)를 구분하는 성질은 변경 가능성입니다.
이 변경 가능성의 대상은 변수 영역 메모리입니다.
즉 한 번 데이터 할당이 이뤄진 변수 공간에 다른 데이터를 재할당할 수 있는지의 여부가 관건입니다.

반면 불변성 여부를 구분할 때의 변경 가능성의 대상은 데이터 영역의 메모리입니다.

기본형 데이터는 모두 불변값입니다.
기본형 데이터를 저장할 때에 한 번 저장된 기본형 데이터는 다른 값으로 변경이 불가능합니다. 변경은 새로 만드는 동작을 통해서만 이뤄집니다. 한 번 만들어진 값은 가비지 컬렉팅을 당하지 않는 한 영원히 변하지 않습니다.

#### 4.2. 가변값

참조형 데이터는 기본적인 성질이 가변값인 경우가 많지만 설정에 따라 변경 불가능한 경우도 있고 아예 불변값으로 활용하는 방안도 있습니다.

참조형 데이터와 기본형 데이터의 차이는 '객체의 변수(프로퍼티)영역'이 별도로 전재한다는 점입니다. 데이터 영역에 저장된 값은 모두 불변값이지만 변수에는 얼마든지 다른 값을 대입할 수 있기 때문에 흔히 참조형 데이터는 불변하지 않다(가변값이다)라고 합니다.

#### 4.3. 변수 복사 비교

### 5. 불변객체

참조형도 기본형과 마찬가지로 새로운 데이터를 할당하고자 할 때 기존 데이터는 변하지 않습니다. 내부 프로퍼티를 변경할 필요가 있을 때마다 매번 새로운 객체를 만들어 재할당 하기로 규칙을 정하거나 자동으로 새로운 객체를 만드는 도구를 활용하면 객체 역시 불변성을 확보할 수 있습니다.

#### 5.1 불변 객체를 만드는 간단한 방법

1. 깊은 복사를 수행하는 함수를 이용

```javascript
var copyObjDeep = function (target) {
  var result = {};
  if (typeof target === "object" && target !== null) {
    for (var prop in target) {
      result[prop] = copyObjDeeg(target[prop]);
    }
  } else result = target;
  return result;
};
```

재귀함수를 이용하여 오브젝트 내의 프로퍼티가 오브젝트일 경우도 모두 복사합니다.

2. JSON을 활용

3. 라이브러리를 사용
   baoba.js, immutable.js 등을 이용합니다.

```javascript
var copyObjViaJSON = function (target) {
  return JSON.parse(JSON.stringify(target));
};
```

JSON.stringify()를 이용하면 깊은 복사를 할 수 있지만,
getter, settter, 메서드 등은 복사 되지 않는다는 단점이 있습니다(데이터만 복사 됩니다).

#### 5.2 얕은 복사와 깊은 복사

- 얕은 복사 는 바로 아래 단계의 값만 복사합니다.
- 깊은 복사 는 내부의 모든 값들을 전부 복사합니다.
  즉, 얕은 복사는 프로퍼티에 대하여 원본과 사본이 모두 동일한 참조형 데이터 주소를 가리키게 됩니다.

### 6. undefined와 null

두 값 모두 없음을 나타내지만 사용 목적과 의미에 다소 차이가 있습니다.

#### 1. undefined

값을 대입하지 않은 변수, 즉 데이터 영역의 메모리 주소를 지정하지 않은 식별자에 접근할 때 리턴되는 값입니다.
객체 내부의 존재하지 않는 프로퍼티에 접근할 때 리턴되는 값입니다.
return 문이 없거나 호출되지 않는 함수의 실행 결과입니다.
undefined를 직접 할당한 경우, 비어있음을 의미하긴 하지만 하나의 값으로 동작합니다.

자바스크립트 엔진은 사용자가 응당 어떤 값을 지정할 것이라고 예상되는 상황임에도 실제로는 그렇게 하지 않았을 때 undefined를 반환합니다.

#### 2. null

undefined가 가져다주는 혼란함을 피하기 위한 데이터 타입입니다.
type이 object (js의 자체버그) 이므로 어떤 변수의 값이 null인지 여부를 판별하기 위해서 일치연산자 (===) 를 이용하여 판별할 수 있습니다.

## 요약

- 자바스크립트 데이터 타입에는 크게 기본형과 참조형이 있습니다. 기본적으로 기본형은 불변값이고 참조형은 가변값입니다.

- 변수는 변경 가능한 데이터가 담길 수 있는 공간이고, 식별자는 그 변수의 이름을 말합니다.

- 변수를 선언하면 컴퓨터는 우선 메모리의 빈 공간에 식별자를 저장하고, 그 공간에 자동으로 undefined를 할당합니다. 이후 그 변수에 기본형 데이터를 할당하려고 하면 별도의 공간에 데이터를 저장하고, 그 공간의 주소를 변소의 값 영역에 할당합니다.

- 참조형 데이터를 할당하고자 할 경우 컴퓨터는 참조형 데이터 내부 프로퍼티들을 위한 변수 영역을 별도로 확보해서 확보된 주소를 변수에 연결하고, 다시 앞서 확보한 변수 영역에 각 프로퍼티의 식별자를 저장하고, 각 데이터를 별도의 공간에 저장해서 그 주소를 식별자들과 매칭시킵니다. 이처럼 할당 과정에서 기본형과의 차이가 생긴 이유는 참조형 데이터가 여러 개의 프로퍼티(변수)를 모은 '그룹'이기 때문입니다. 그리고 이 차이로 인해 참조형 데이터를 '가변값'으로 여겨야만 하는 상황이 발생합니다.

- 참조형 데이터를 가변값으로 여겨야 하는 상황임에도 이를 불벼값으로 사용하는 방법이 없지는 않습니다. 이 경우 내부 프로퍼티들을 일일이 복사하면 됩니다(깊은 복사). 혹은 라이브러리를 사용하는 방법도 있습니다. 불변 객체는 최근 자바스크립트 진영에서 가장 중요한 개념 중 하나입니다.

- '없음'을 나타내는 값은 두 가지가 있는데, undefined는 어떤 변수에 값이 존재하지 않을 경우를 의미하고 null은 사용자가 명시적으로 '없음'을 표현하기 위해 대입한 값입니다. 본래의 의미에 따라 사용자가 없음을 표현하기 위해 명시적으로 undefined를 대입하는 것은 지양하는 것이 좋겠습니다.

## 참고

- [코어자바스크립트](http://www.yes24.com/Product/Goods/78586788)
- [코어자바스크립트 요약 블로그1](https://www.sunhodev.com/blog/javascript/data-type)
- [코어자바스크립트 요약 블로그2](https://velog.io/@imjkim49/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85-%EC%A0%95%EB%A6%AC)
